number: 21
title: Zombies in a country
description: |
  Find zombies within the given country, and return their zombie scores.

  A zombie is a Person created before the given `endDate` and that has created between `[0, 1)` Messages per month,
  on average, during the time range between profile creation date and the given `endDate`.

  The number of months spans the time range from creation date of the profile to the `endDate` and also includes
  partial months.
parameters:
  - name: country
    type: String
  - name: endDate
    type: Date
result:
  - name: person.id
    type: 64-bit Integer
  - name: zombieLikeCount
    type: 32-bit Integer
  - name: realLikeCount
    type: 32-bit Integer
    comment: I think this should be `totalLikeCount` -- szarnyasg
  - name: zombieScore
    type: 32bitFloat
    description: the ratio between the number of likes received from zombies (`zombieLikeCount`) and the total number of likes received on that person's messages (`realLikeCount`) -- only count likes received from profiles that were created before the given `endDate`.
sort:
  - name: zombieScore
    direction: desc
  - name: person.id
    direction: asc
limit: 100
choke_points: [1.2, 2.1, 2.3, 2.4, 3.2, 3.3, 5.1, 5.3]
